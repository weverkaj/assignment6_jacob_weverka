---
title: "Political and Environmentalist Self-Identification"
author: "Jacob Weverka"
date: "12/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(stargazer)

```
Read in the data and select the columns we need.

```{r}
survey = read_csv(here::here("data/conservation_survey.csv"))

simple = survey %>%
  select(ENV_ID, POL_OR)

```


To your simplified data frame, add a new column that bins the political party into a binary response of either “conservative” (if POL_OR is 1 - 3) or “liberal” (if POL_OR 5 - 7). All other political affiliations (4, 8, 9) should be excluded for this task. Hint: you might want to use dplyr::mutate() + dplyr::case_when() here. 


```{r}
binned = simple %>%
  mutate(category = 
           case_when(
              POL_OR <= 3 ~ "Conservative",
              POL_OR >= 5 ~ "Liberal"
              ),
         response = 
           case_when(
             ENV_ID == 1 ~ "Yes",
             ENV_ID == 2 ~ "No",
             ENV_ID == 3 ~ "Unsure"
           )
  ) %>%
  drop_na()
```

Create a finalized table that shows the counts and proportions of “liberal” and “conservative” survey respondents who responded “Yes”, “No” and “Unsure” to the statement “I consider myself an environmentalist.” Hint: see the Week 9 Coding Lesson key for hints on how to do this. This table should appear in the knitted document, with a table caption above it. 



```{r}
political_table = binned %>%
  tabyl(category, response)

political_p = political_table %>%
  adorn_percentages() %>%
  adorn_pct_formatting(digits = 2)

political_proportions = political_p %>%
  adorn_ns() %>%
  relocate(category, Yes, No, Unsure) %>%
  clean_names("upper_camel")

lib_yes = political_p %>%
  filter(category == "Liberal") %>%
  select(Yes)

con_yes = political_p %>%
  filter(category == "Conservative") %>%
  select(Yes)





knitr::kable(political_proportions, caption = "Proportions of Liberals and Conservatives that Identify as Environmentalists. Actual survey counts are in parentheses next to percentages.")

```


Then, write code to convert the counts table to a contingency table (hint: column_to_rownames()) and perform a chi-square test for independence to answer: is there an association between political affiliation (conservative or liberal-leaning) and if a person considers themself an environmentalist? 




```{r}

env_ct = political_table %>%
  column_to_rownames(var = "category")


```


Chi-square test

```{r}

env_x2 = chisq.test(env_ct)
env_x2

env_tidy = broom::tidy(env_x2)

```
There is a significant association between political preference and self-identification as an environmentalist ($\chi$^2^(`r env_tidy$parameter`). = `r round(env_tidy$statistic,2)`, *p* = `r round(env_tidy$p.value, 3)`). It appears that politically liberal people are more likely to identify as environmentalists, with `r lib_yes ` identifying as environmentalists, compared to `r con_yes` of conservatives self-identifying as environmentalists.        `
































